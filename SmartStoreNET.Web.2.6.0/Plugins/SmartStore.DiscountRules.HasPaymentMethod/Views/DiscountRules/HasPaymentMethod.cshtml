@{
    Layout = "";
}
@model SmartStore.DiscountRules.HasPaymentMethod.Models.HasPaymentMethodModel
@using SmartStore.Web.Framework;
@using SmartStore;

<script>
    $(function () {
    	var selectedPaymentMethods = '@Model.PaymentMethods.EmptyNull()'.split(',');
    	$("#@Html.FieldIdFor(model => model.PaymentMethods)").select2().select2('val', selectedPaymentMethods);

    	var prefix = '@ViewData.TemplateInfo.HtmlFieldPrefix';
    	window[prefix + '_getPaymentMethods'] = function () {
    		var paymentMethods = $("#@Html.FieldIdFor(model => model.PaymentMethods)").val();
    		return paymentMethods ? paymentMethods.join() : '';
    	};
    });
</script>

<table class="adminContent">
	<tr>
		<td class="adminTitle">
			@Html.SmartLabelFor(model => model.PaymentMethods)
		</td>
		<td class="adminData">
			<div class="discount-rule-wrapper"
				 data-discount-id='@Model.DiscountId'
				 data-requirement-id='@Model.RequirementId'
				 data-action-url='@Url.Action("HasPaymentMethod")'
				 data-fail-msg='@T("Admin.Promotions.Discounts.Requirements.FailedToSave").Text.EncodeJsString()'
				 data-success-msg='@T("Admin.Promotions.Discounts.Requirements.Saved").Text.EncodeJsString()'>
				<div>
					@Html.DropDownListFor(model => model.PaymentMethods, Model.AvailablePaymentMethods, new { multiple = "multiple", data_routeparam = "paymentMethods", data_routevalue = ViewData.TemplateInfo.HtmlFieldPrefix + "_getPaymentMethods" })
					<button type="button" class="btn btn-save-discount-rule">
						<i class="fa fa-check"></i>
						@T("Admin.Common.Save")
					</button>
				</div>
			</div>
		</td>
	</tr>
</table>