@{
    Layout = "";
}
@model SmartStore.DiscountRules.HasShippingOption.Models.HasShippingOptionModel
@using SmartStore.Web.Framework;
@using SmartStore;

<script>
    $(function () {
    	var selectedShippingMethods = '@Model.ShippingOptions.EmptyNull()'.split(',');
    	$("#@Html.FieldIdFor(model => model.ShippingOptions)").select2().select2('val', selectedShippingMethods);

    	var prefix = '@ViewData.TemplateInfo.HtmlFieldPrefix';
    	window[prefix + '_getShippingOptions'] = function () {
    		var shippingOptions = $("#@Html.FieldIdFor(model => model.ShippingOptions)").val();
    		return shippingOptions ? shippingOptions.join() : '';
    	};
    });
</script>

<table class="adminContent">
	<tr>
		<td class="adminTitle">
			@Html.SmartLabelFor(model => model.ShippingOptions)
		</td>
		<td class="adminData">
			<div class="discount-rule-wrapper"
				 data-discount-id='@Model.DiscountId'
				 data-requirement-id='@Model.RequirementId'
				 data-action-url='@Url.Action("HasShippingOption")'
				 data-fail-msg='@T("Admin.Promotions.Discounts.Requirements.FailedToSave").Text.EncodeJsString()'
				 data-success-msg='@T("Admin.Promotions.Discounts.Requirements.Saved").Text.EncodeJsString()'>
				<div>
					@Html.DropDownListFor(model => model.ShippingOptions, Model.AvailableShippingMethods, new { multiple = "multiple", data_routeparam = "shippingOptions", data_routevalue = ViewData.TemplateInfo.HtmlFieldPrefix + "_getShippingOptions" })
					<button type="button" class="btn btn-save-discount-rule">
						<i class="fa fa-check"></i>
						@T("Admin.Common.Save")
					</button>
				</div>
			</div>
		</td>
	</tr>
</table>