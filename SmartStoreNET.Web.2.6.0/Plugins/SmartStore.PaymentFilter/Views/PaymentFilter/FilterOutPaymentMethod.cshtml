@using SmartStore.PaymentFilter;
@using SmartStore.PaymentFilter.Models;
@model FilterOutPaymentMethodModel
@{
	Layout = null;
}

@Html.Hidden("__Type__", Model.GetType().AssemblyQualifiedName)

<table id="PaymentMethodFilterControls" class="adminContent">
	<tr>
		<td class="adminTitle">
			@Html.SmartLabelFor(model => model.ExcludedCustomerRoles)
		</td>
		<td class="adminData">
			@Html.ListBoxFor(model => model.ExcludedCustomerRoles,
				new MultiSelectList(Model.AvailableCustomerRoles, "Value", "Text"),
				new { multiple = "multiple", @class = "control-xlarge" })
			@Html.ValidationMessageFor(model => model.ExcludedCustomerRoles)
		</td>
	</tr>
	<tr>
		<td class="adminTitle">
			@Html.SmartLabelFor(model => model.ExcludedShippingMethods)
		</td>
		<td class="adminData">
			@Html.ListBoxFor(model => model.ExcludedShippingMethods,
				new MultiSelectList(Model.AvailableShippingMethods, "Value", "Text"),
				new { multiple = "multiple", @class = "control-xlarge" })
			@Html.ValidationMessageFor(model => model.ExcludedShippingMethods)
		</td>
	</tr>
	<tr>
		<td class="adminTitle">
			@Html.SmartLabelFor(model => model.ExcludedCountries)
		</td>
		<td class="adminData">
			@Html.ListBoxFor(model => model.ExcludedCountries,
				new MultiSelectList(Model.AvailableCountries, "Value", "Text"),
				new { multiple = "multiple", @class = "control-xlarge" })

			<div class="btn-group">
				<a class="btn dropdown-toggle" data-toggle="dropdown" href="#">
					@T("Plugins.Shipping.ShippingFilter.Selection")
					<span class="fa fa-caret-down"></span>
				</a>
				<ul class="dropdown-menu">
					<li>
						<a href="javascript:void(0)" class="selection-button" data-type="All">
							@T("Common.All")
						</a>
					</li>
					<li>
						<a href="javascript:void(0)" class="selection-button" data-type="Remove">
							@T("Common.Remove")
						</a>
					</li>
					<li>
						<a href="javascript:void(0)" class="selection-button" data-type="Reverse">
							@T("Plugins.Shipping.ShippingFilter.Reverse")
						</a>
					</li>
					<li>
						<a href="javascript:void(0)" class="selection-button" data-type="Eu">
							@T("Plugins.Shipping.ShippingFilter.Eu")
						</a>
					</li>

				</ul>
			</div>

			@Html.ValidationMessageFor(model => model.ExcludedCountries)
		</td>
	</tr>
	<tr>
		<td class="adminTitle">
			@Html.SmartLabelFor(model => model.CountryContext)
		</td>
		<td class="adminData">
			@Html.DropDownListFor(model => model.CountryContext, Model.AvailableCountryContextTypes)
			@Html.ValidationMessageFor(model => model.CountryContext)
		</td>
	</tr>
	<tr>
		<td class="adminTitle">
			@Html.SmartLabelFor(model => model.MinimumOrderAmount)
		</td>
		<td class="adminData">
			@Html.EditorFor(model => model.MinimumOrderAmount)
			@Html.ValidationMessageFor(model => model.MinimumOrderAmount)
		</td>
	</tr>
	<tr>
		<td class="adminTitle">
			@Html.SmartLabelFor(model => model.MaximumOrderAmount)
		</td>
		<td class="adminData">
			@Html.EditorFor(model => model.MaximumOrderAmount)
			@Html.ValidationMessageFor(model => model.MaximumOrderAmount)
		</td>
	</tr>
	<tr>
		<td class="adminTitle">
			@Html.SmartLabelFor(model => model.AmountContext)
		</td>
		<td class="adminData">
			@Html.DropDownListFor(model => model.AmountContext, Model.AvailableAmountContextTypes)
			@Html.ValidationMessageFor(model => model.AmountContext)
		</td>
	</tr>
	<tr>
		<td class="adminTitle">
			@Html.SmartLabelFor(m => m.HasLessThanOrders)
		</td>
		<td class="adminData">
			<div class="pull-left">
				@Html.EditorFor(m => m.HasLessThanOrders)
				@Html.ValidationMessageFor(m => m.HasLessThanOrders)
			</div>
		</td>
	</tr>
	<tr>
		<td class="adminTitle">
			@Html.SmartLabelFor(m => m.HasLessThanTotalAmount)
		</td>
		<td class="adminData">
			<div class="pull-left">
				@Html.EditorFor(m => m.HasLessThanTotalAmount)
				@Html.ValidationMessageFor(m => m.HasLessThanTotalAmount)
			</div>
		</td>
	</tr>
</table>

<script type="text/javascript">
	$(document).ready(function () {
		$('#PaymentMethodFilterControls').find('select').selectWrapper();

		$('#PaymentMethodFilterControls .selection-button').click(function () {
			var select = $(this).closest('.adminData').find('select:first'),
				type = $(this).attr('data-type'),
				val = select.val(),
				data = '';

			if (val) {
				data = val.join();
			}

			$({}).doAjax({
				url: '@Url.Action("CountrySelection", "PaymentFilter", new { area = PaymentFilterPlugin.SystemName })',
				data: 'type=' + type + '&existingCountries=' + data,
				callbackSuccess: function (response) {
					select.select2('data', response);
				}
			});
		});
    });
</script>